@using System.Data;
@using Autravel.Extentions;
@using Autravel.Models.Function;
@{
    ViewBag.Title = "Combo trọn gói";
    var ChuDe = (DataTable)ViewBag.ChuDe;
    var BanChay = (DataTable)ViewBag.BanChay;
    var DiaDiem = (DataTable)ViewBag.DiaDiem;
    var CamNang = (DataTable)ViewBag.CamNang;
    var BANNER = (DataTable)ViewBag.BANNER;
}

<style>
    #carouselChuDe .titel {
        color: white
    }

    #slider-text {
        padding-top: 40px;
        display: block;
    }

        #slider-text .col-md-6 {
            overflow: hidden;
        }

        #slider-text h2 {
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 400;
            font-size: 30px;
            letter-spacing: 3px;
            margin: 30px auto;
            padding-left: 40px;
        }

            #slider-text h2::after {
                border-top: 2px solid #c7c7c7;
                content: "";
                position: absolute;
                bottom: 35px;
                width: 100%;
            }

    #carouselChuDe h4 {
        font-family: 'Josefin Sans', sans-serif;
        font-weight: 400;
        font-size: 12px;
        margin: 10px auto 3px;
    }

    #carouselChuDe h5 {
        font-family: 'Josefin Sans', sans-serif;
        font-weight: bold;
        font-size: 12px;
        margin: 3px auto 2px;
    }

    #carouselChuDe h6 {
        font-family: 'Josefin Sans', sans-serif;
        font-weight: 300;
        ;
        font-size: 10px;
        margin: 2px auto 5px;
    }

    .badge {
        background: #b20c0c;
        position: absolute;
        height: 40px;
        width: 40px;
        border-radius: 50%;
        line-height: 31px;
        font-family: 'Josefin Sans', sans-serif;
        font-weight: 300;
        font-size: 14px;
        border: 2px solid #FFF;
        box-shadow: 0 0 0 1px #b20c0c;
        top: 5px;
        right: 25%;
    }

    #slider-control img {
        padding-top: 60%;
        margin: 0 auto;
    }

    @@media screen and (max-width: 992px) {
        #slider-control img {
            padding-top: 70px;
            margin: 0 auto;
        }
    }

    .carousel-showmanymoveone .carousel-control {
        width: 4%;
        background-image: none;
    }

        .carousel-showmanymoveone .carousel-control.left {
            margin-left: 5px;
        }

        .carousel-showmanymoveone .carousel-control.right {
            margin-right: 5px;
        }

    .carousel-showmanymoveone .cloneditem-1,
    .carousel-showmanymoveone .cloneditem-2,
    .carousel-showmanymoveone .cloneditem-3,
    .carousel-showmanymoveone .cloneditem-4,
    .carousel-showmanymoveone .cloneditem-5 {
        display: none;
    }

    @@media all and (min-width: 768px) {
        .carousel-showmanymoveone .carousel-inner > .active.left,
        .carousel-showmanymoveone .carousel-inner > .prev {
            left: -50%;
        }

        .carousel-showmanymoveone .carousel-inner > .active.right,
        .carousel-showmanymoveone .carousel-inner > .next {
            left: 50%;
        }

        .carousel-showmanymoveone .carousel-inner > .left,
        .carousel-showmanymoveone .carousel-inner > .prev.right,
        .carousel-showmanymoveone .carousel-inner > .active {
            left: 0;
        }

        .carousel-showmanymoveone .carousel-inner .cloneditem-1 {
            display: block;
        }
    }

    @@media all and (min-width: 768px) and (transform-3d), all and (min-width: 768px) and (-webkit-transform-3d) {
        .carousel-showmanymoveone .carousel-inner > .item.active.right,
        .carousel-showmanymoveone .carousel-inner > .item.next {
            -webkit-transform: translate3d(50%, 0, 0);
            transform: translate3d(50%, 0, 0);
            left: 0;
        }

        .carousel-showmanymoveone .carousel-inner > .item.active.left,
        .carousel-showmanymoveone .carousel-inner > .item.prev {
            -webkit-transform: translate3d(-50%, 0, 0);
            transform: translate3d(-50%, 0, 0);
            left: 0;
        }

            .carousel-showmanymoveone .carousel-inner > .item.left,
            .carousel-showmanymoveone .carousel-inner > .item.prev.right,
            .carousel-showmanymoveone .carousel-inner > .item.active {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
                left: 0;
            }
    }

    @@media all and (min-width: 992px) {
        .carousel-showmanymoveone .carousel-inner > .active.left,
        .carousel-showmanymoveone .carousel-inner > .prev {
            left: -16.666%;
        }

        .carousel-showmanymoveone .carousel-inner > .active.right,
        .carousel-showmanymoveone .carousel-inner > .next {
            left: 16.666%;
        }

        .carousel-showmanymoveone .carousel-inner > .left,
        .carousel-showmanymoveone .carousel-inner > .prev.right,
        .carousel-showmanymoveone .carousel-inner > .active {
            left: 0;
        }

        .carousel-showmanymoveone .carousel-inner .cloneditem-2,
        .carousel-showmanymoveone .carousel-inner .cloneditem-3,
        .carousel-showmanymoveone .carousel-inner .cloneditem-4,
        .carousel-showmanymoveone .carousel-inner .cloneditem-5,
        .carousel-showmanymoveone .carousel-inner .cloneditem-6 {
            display: block;
        }
    }

    @@media all and (min-width: 992px) and (transform-3d), all and (min-width: 992px) and (-webkit-transform-3d) {
        .carousel-showmanymoveone .carousel-inner > .item.active.right,
        .carousel-showmanymoveone .carousel-inner > .item.next {
            -webkit-transform: translate3d(16.666%, 0, 0);
            transform: translate3d(16.666%, 0, 0);
            left: 0;
        }

        .carousel-showmanymoveone .carousel-inner > .item.active.left,
        .carousel-showmanymoveone .carousel-inner > .item.prev {
            -webkit-transform: translate3d(-16.666%, 0, 0);
            transform: translate3d(-16.666%, 0, 0);
            left: 0;
        }

            .carousel-showmanymoveone .carousel-inner > .item.left,
            .carousel-showmanymoveone .carousel-inner > .item.prev.right,
            .carousel-showmanymoveone .carousel-inner > .item.active {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
                left: 0;
            }
    }
</style>
<div class="banner-site">
    <div class="slider-banner">
        <div id="SlideBannerCombo" class="carousel slide" data-ride="carousel">

            <div class="carousel-inner">
                @foreach (DataRow item in BANNER.Rows)
                {
                    <div class="item">
                        <img src="@item["UrlFile"]">
                    </div>
                }
            </div>

            <!-- Left and right controls -->
            <a class="left carousel-control" href="#SlideBannerCombo" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#SlideBannerCombo" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
    <div class="content-banner">
        <div class="container">
            <div class="content">
                <h3 class="titel-banner">@Text.Show("Combo_Intro")</h3>
                <span class="sologan-banner">@Text.Show("Combo_Intro_sub")</span>
                <div class="searchbox-banner">
                    <form class="formsearch" action="/s/all" method="get" role="search">
                        <div class="div-location">
                            <label class="titel-lbl-location">Địa điểm </label>
                            <input class="inp-location" id="inp-location" placeholder="Bạn sắp đi đâu?" />
                        </div>
                        <div class="div-Departure">
                            <label class="lbl-Departure">
                                <div class="titel-lbl-Departure">Thời gian </div>
                                <input class="inp-Departure" id="inp-Departure" placeholder="Vui lòng chọn thời gian!" />
                            </label>
                        </div>
                        <div class="div-btnSearchbox">
                            <a class="btn btn-primary" id="btnSearchbox">
                                <i class="fa  fa-search"></i>
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="ComboForYou">
    <div class="container">
        <div class="headingContent">
            <h4 class="heading">Bán chạy nhất tuần</h4>
            <span class="description-heading">Lên đường săn tuyến với combo Sapa của Autravel</span>
        </div>
        <div class="body-content-Combo">

            <div id="carouselBanChay" class="carousel slide" data-ride="carousel" data-type="multi" num="4" data-interval="2500">
                <div class="carousel-inner">

                    @foreach (DataRow item in BanChay.Rows)
                    {
                        <div class="item">
                            <div class="carousel-col">
                                <a href="/PCombo/Details/@item["Tour_ID"]">
                                    <div class="combo-item">
                                        <div class="div-img-combo">
                                            <img class="img-combo" src="@item["Tour_Image"]" />
                                            <span class="time-duration">@item["Tour_TimeZoneText"]</span>
                                        </div>
                                        <div class="titel-combo">
                                            <div class="rateStar-item">
                                                @Html.Raw(Funtions.FillStarView(item.ToFloat("Tour_StarRate")))
                                            </div>
                                            <span class="extention-combo">Trọn gói: Khách sạn + xe khứ hồi</span>
                                            <div class="price-item">@item.ToIntCurrency("Tour_Price") ₫</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    }
                </div>

                <!-- Controls -->
                <div class="left carousel-control">
                    <a href="#carouselBanChay" role="button" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                </div>
                <div class="right carousel-control">
                    <a href="#carouselBanChay" role="button" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>



        </div>
    </div>
</div>
<div class="ComboBestSelling">
    <div class="container">
        <div class="headingContent">
            <h4 class="heading">Combo dành riêng cho bạn</h4>
            <span class="description-heading">Khám phá những Combo đặc biệt nhé</span>
        </div>
        <div class="body-content-Combo">
            <div class="carousel carousel-showmanymoveone slide"  data-type="multi"  num="6" id="carouselChuDe">
                <div class="carousel-inner">
                    @foreach (DataRow item in ChuDe.Rows)
                    {
                        <div class="item">
                            <div class="col-xs-12 col-sm-6 col-md-2">
                                <a href="/PCombo/ListCombo"><img src="@item["TopicTour_Image"]"  class="img-responsive center-block"></a>
                                 <h4 class="text-center">@item["TopicTour_Name"]</h4>
                             </div>
                        </div>

                        @*<div class="item">
                            <div class="carousel-col">
                                <a href="/PCombo/ListCombo">
                                    <div class="combo-item">
                                        <div class="div-img-combo">
                                            <img class="img-combo" src="@item["TopicTour_Image"]" />
                                        </div>
                                        <div class="titel-combo">
                                            <b class="titel">@item["TopicTour_Name"]</b>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>*@
                    }
                </div>

                <div id="slider-control">
                    <a class="left carousel-control" href="#carouselChuDe" data-slide="prev"><img src="https://cdn0.iconfinder.com/data/icons/website-kit-2/512/icon_402-512.png" alt="Left" class="img-responsive"></a>
                    <a class="right carousel-control" href="#carouselChuDe" data-slide="next"><img src="http://pixsector.com/cache/81183b13/avcc910c4ee5888b858fe.png" alt="Right" class="img-responsive"></a>
                </div>
            </div>
          
        </div>
    </div>
</div>
<div class="PopularPlaces">
    <div class="container">
        <div class="headingContent">
            <h4 class="heading">Địa điểm phổ biến</h4>
            <span class="description-heading">Cùng Autravel khám phá những địa điểm đẹp nhé:</span>
        </div>
        <div class="body-content-Combo">
            <div id="carouselDiaDiem" class="carousel slide" data-ride="carousel" data-type="multi" num="4" data-interval="2500">
                <div class="carousel-inner">

                    @foreach (DataRow item in DiaDiem.Rows)
                    {
                        <div class="item">
                            <div class="carousel-col">
                                <a href="/PCombo/ListCombo">
                                    <div class="combo-item">
                                        <div class="div-img-combo">
                                            <img class="img-combo" src="@item["Location_images"]" />
                                        </div>
                                        <div class="titel-combo">
                                            <span class="titel"><a href="/">@item["Location_Name"]</a></span>
                                            <span class="total-combo">2 combo</span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    }
                </div>

                <!-- Controls -->
                <div class="left carousel-control">
                    <a href="#carouselDiaDiem" role="button" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                </div>
                <div class="right carousel-control">
                    <a href="#carouselDiaDiem" role="button" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>

        </div>
    </div>
</div>
<div class="Hanbook">
    <div class="container">
        <div class="headingContent">
            <h4 class="heading">Cẩm nang du lịch</h4>
            <span class="description-heading">Chuẩn bị hành trang cùng Autravel</span>
        </div>
        <div class="body-content-Combo">
            <div id="carouselCamNang" class="carousel slide" data-ride="carousel" data-type="multi" num="4" data-interval="2500">
                <div class="carousel-inner">

                    @foreach (DataRow item in CamNang.Rows)
                    {
                        <div class="item">
                            <div class="carousel-col">
                                <a href="/PCombo/Details">
                                    <div class=" combo-item">
                                        <div class="div-img-combo">
                                            <img class="img-combo" src="@item["Post_Images"]" />
                                        </div>
                                        <div class="titel-combo">
                                            <b class="description-combo">@item["Post_Tile"]</b>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    }
                </div>

                <div class="left carousel-control">
                    <a href="#carouselCamNang" role="button" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                </div>
                <div class="right carousel-control">
                    <a href="#carouselCamNang" role="button" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>

        </div>
    </div>
</div>
<script type="text/javascript">
    //Datepicker
    $(document).ready(function () {
        function getDaysOfMonth(year, month) {

            var monthStart = new Date(year, month, 1);
            var monthEnd = new Date(year, month + 1, 1);
            var monthLength = (monthEnd - monthStart) / (1000 * 60 * 60 * 24);
            return monthLength;

        }
        var d = new Date();
        var AutoDay = d.getDate() + 3;
        var AutoDayEnd = d.getDate() + 5;
        var TotalDayOfMonth = getDaysOfMonth(d.getFullYear(), d.getMonth());
        var AutoMonth = (d.getMonth() + 1);
        var AutoMonthEnd = (d.getMonth() + 1);
        var AutoYear = d.getFullYear();
        var AutoYearEnd = d.getFullYear();
        if (AutoDay > TotalDayOfMonth) {
            AutoDay = AutoDay - TotalDayOfMonth;
            AutoMonth += 1;
            if (AutoMonth > 12) {
                AutoYear += 1;
                AutoMonth = 1;
            }
        }
        if (AutoDayEnd > TotalDayOfMonth) {
            AutoDayEnd = AutoDayEnd - TotalDayOfMonth;
            AutoMonthEnd += 1;
            if (AutoMonthEnd > 12) {
                AutoYearEnd += 1;
                AutoMonthEnd = 1;
            }
        }
        output = [

            ('0' + AutoDay).substr(-2), ('0' + AutoMonth).substr(-2),
            AutoYear
        ].join('/');
        outputend = [

            ('0' + AutoDayEnd).substr(-2), ('0' + AutoMonthEnd).substr(-2),
            AutoYearEnd
        ].join('/');
        $('#inp-Departure').val(output + ' đến ' + outputend);
        $('#inp-Departure').attr("From", output);
        $('#inp-Departure').attr("To", outputend);
    });
    $('#inp-Departure').dateRangePicker({
        autoClose: true,
        format: 'DD/MM/YYYY',
        separator: ' đến ',
        language: 'vi',
        startOfWeek: 'monday',// or monday
        getValue: function () {
            return $(this).val();
        },
        setValue: function (s) {
            if (!$(this).attr('readonly') && !$(this).is(':disabled') && s != $(this).val()) {
                $(this).val(s);
            }
        },
        startDate: new Date(),
        endDate: false,
        time: {
            enabled: false
        },
        minDays: 0,
        maxDays: 0,
        showShortcuts: false,
        shortcuts:
        {
            //'prev-days': [1,3,5,7],
            //'next-days': [3,5,7],
            //'prev' : ['week','month','year'],
            //'next' : ['week','month','year']
        },
        customShortcuts: [],
        inline: false,
        container: 'body',
        alwaysOpen: false,
        singleDate: false,
        lookBehind: false,
        batchMode: false,
        duration: 200,
        stickyMonths: false,
        dayDivAttrs: [],
        dayTdAttrs: [],
        applyBtnClass: '',
        singleMonth: 'auto',
        hoveringTooltip: function (days, startTime, hoveringTime) {
            //return days > 1 ? days + ' ' + lang('days') : '';
        },
        showTopbar: true,
        swapTime: false,
        selectForward: false,
        selectBackward: false,
        showWeekNumbers: false,
        getWeekNumber: function (date) //date will be the first day of a week
        {
            return moment(date).format('w');
        },
        monthSelect: false,
        yearSelect: false
    }).bind('datepicker-change', function (event, obj) {
        console.log(obj);
        $('#inp-Departure').attr("From", moment(obj.date1).format('YYYY-MM-DD'));
        $('#inp-Departure').attr("To", moment(obj.date2).format('YYYY-MM-DD'));

    });;


    $.ajax({
        type: "POST",
        url: "/Pcombo/GetLocation",
        dataType: "json",
        success: function (response) {
            var response = JSON.parse(response);
            var objectKeys = $.map(response, function (value, key) {
                return value.Location_Name;
            });
            console.log(objectKeys);
            autocomplete(document.getElementById("inp-location"), objectKeys);
        }
    });
    $("#btnSearchbox").click(function (e) {
        e.preventDefault();
        var KeySearch = $("#inp-location").val();
        var From = $('#inp-Departure').attr("From");
        var To = $('#inp-Departure').attr("To");
        KeySearch = encodeURI(KeySearch);
        window.location.href = "/PCombo/ListCombo?KeySearch=" + KeySearch + "&From=" + From + "&To=" + To;
    });
</script>
<script>
    $("#SlideBannerCombo .carousel-inner .item:eq(0)").addClass("active");
</script>


<script>
    $("#carouselCamNang .carousel-inner .item:eq(0)").addClass("active");
    $("#carouselDiaDiem .carousel-inner .item:eq(0)").addClass("active");
    $("#carouselBanChay .carousel-inner .item:eq(0)").addClass("active");
    $("#carouselChuDe .carousel-inner .item:eq(0)").addClass("active");
</script>



<script>

        $(document).ready(function () {
            $('.carousel[data-type="multi"] .item').each(function () {
                var itemToClone = $(this);
                var itemNum = $(this).closest(".carousel").attr("num");
                console.log(itemNum);
                for (var i = 1; i < itemNum; i++) {
                    itemToClone = itemToClone.next();

                    if (!itemToClone.length) {
                        itemToClone = $(this).siblings(':first');
                    }

                    itemToClone.children(':first-child').clone()
                        .addClass("cloneditem-" + (i))
                        .appendTo($(this));
                }
            });
        });

    </script>

 